---
import '../styles/global.css';

interface Props {
  title: string;
  description: string;
  canonical?: string;
  ogImage?: string;
  ogType?: string;
  keywords?: string;
  jsonLd?: any[];
}

const {
  title,
  description,
  canonical = Astro.url.pathname,
  ogImage = '/assets/covers/avatar-world-cover.png',
  ogType = 'website',
  keywords = 'avatar world, avatar world online, avatar world game, play avatar world, avatar world free, avatar world unblocked, avatar world pazu, simulation games for kids, role playing games, life simulation games, games like toca boca, character creation games',
  jsonLd = []
} = Astro.props;

const siteUrl = 'https://avatarworldonline.com';
const fullUrl = `${siteUrl}${canonical}`;
const fullOgImage = ogImage.startsWith('http') ? ogImage : `${siteUrl}${ogImage}`;
---

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="Permissions-Policy" content="geolocation=(), microphone=(), camera=()">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
  
  <!-- Primary Meta Tags -->
  <title>{title}</title>
  <meta name="title" content={title}>
  <meta name="description" content={description}>
  <meta name="keywords" content={keywords}>
  <meta name="author" content="Avatar World Online">
  <meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1">
  <meta name="googlebot" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1">
  <meta name="bingbot" content="index, follow">
  
  <!-- Language Alternates -->
  <link rel="alternate" hreflang="en" href={fullUrl}>
  <link rel="alternate" hreflang="x-default" href={fullUrl}>
  
  <!-- Canonical URL -->
  <link rel="canonical" href={fullUrl}>
  
  <!-- Open Graph / Facebook -->
  <meta property="og:type" content={ogType}>
  <meta property="og:url" content={fullUrl}>
  <meta property="og:title" content={title}>
  <meta property="og:description" content={description}>
  <meta property="og:image" content={fullOgImage}>
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">
  <meta property="og:image:alt" content="Avatar World - Play Free Online Simulation Game">
  <meta property="og:site_name" content="Avatar World Online">
  <meta property="og:locale" content="en_US">
  
  <!-- Twitter -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:url" content={fullUrl}>
  <meta name="twitter:title" content={title}>
  <meta name="twitter:description" content={description}>
  <meta name="twitter:image" content={fullOgImage}>
  <meta name="twitter:image:alt" content="Avatar World - Play Free Online">
  
  <!-- Favicon -->
  <link rel="icon" type="image/x-icon" href="/favicon.ico">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="48x48" href="/favicon-48x48.png">
  
  <!-- Apple Touch Icons -->
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/apple-touch-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/apple-touch-icon-120x120.png">
  
  <!-- Android Chrome Icons -->
  <link rel="icon" type="image/png" sizes="192x192" href="/android-chrome-192x192.png">
  <link rel="icon" type="image/png" sizes="512x512" href="/android-chrome-512x512.png">
  
  <!-- Web App Manifest -->
  <link rel="manifest" href="/site.webmanifest">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="Avatar World">
  <meta name="application-name" content="Avatar World Online">
  <meta name="msapplication-TileColor" content="#1a1a2e">
  <meta name="msapplication-config" content="/browserconfig.xml">
  
  <!-- Preload Critical Assets -->
  <link rel="preload" href="/assets/icons/avatar-world-icon.png" as="image" type="image/png">
  <link rel="preload" href="/assets/covers/avatar-world-cover.png" as="image" type="image/png">
  
  <!-- DNS Prefetch for Performance -->
  <link rel="dns-prefetch" href="https://avatarworldonline.com">
  <link rel="dns-prefetch" href="https://fonts.googleapis.com">
  <link rel="dns-prefetch" href="https://fonts.gstatic.com">
  
  <!-- Preconnect to external domains -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  
  <!-- Theme Color -->
  <meta name="color-scheme" content="dark light">
  <meta name="theme-color" content="#1a1a2e" media="(prefers-color-scheme: dark)">
  <meta name="theme-color" content="#1a1a2e" media="(prefers-color-scheme: light)">
  
  <!-- JSON-LD Structured Data -->
  {jsonLd.map((schema) => (
    <script type="application/ld+json" set:html={JSON.stringify(schema)} />
  ))}
  
  <!-- WebSite Schema -->
  <script type="application/ld+json" set:html={JSON.stringify({
    "@context": "https://schema.org",
    "@type": "WebSite",
    "name": "Avatar World Online",
    "alternateName": ["Avatar World", "Avatar World Game", "Play Avatar World"],
    "url": siteUrl,
    "description": "Play Avatar World online for free! Create characters, explore cities, build homes. Best simulation game for kids by Pazu Games. No download needed!",
    "inLanguage": "en",
    "potentialAction": {
      "@type": "SearchAction",
      "target": {
        "@type": "EntryPoint",
        "urlTemplate": `${siteUrl}/search?q={search_term_string}`
      },
      "query-input": "required name=search_term_string"
    }
  })} />
</head>
<body>
  <!-- Skip to main content for accessibility -->
  <a href="#main-content" class="skip-to-main">Skip to main content</a>
  
  <slot />
  
  <!-- Service Worker Registration -->
  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('/sw.js').catch(() => {});
      });
    }
  </script>
</body>
</html>
